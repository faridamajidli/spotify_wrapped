# -*- coding: utf-8 -*-
"""8 dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1nMSZUKud0YM68kZb1bU6F8p-x0oyWib_
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
from plotnine import *
import matplotlib as plt
import numpy as np

data = pd.read_csv("/content/drive/MyDrive/Stream Spotify Project/Spotify-2000.csv")
data.head()

missing_values_count = data.isnull().sum()
print(missing_values_count)

data = data.drop(columns=['Beats Per Minute (BPM)', 'Energy', 'Danceability', 'Loudness (dB)', 'Liveness', 'Valence', 'Acousticness', 'Speechiness'])

data.head()

unique_artists = data['Artist'].unique()
artist_to_id = {artist: i + 1000 for i, artist in enumerate(unique_artists)}
data['ArtistID'] = data['Artist'].map(artist_to_id)
columns = list(data.columns)
artist_index = columns.index('Artist')
columns.insert(artist_index, columns.pop(columns.index('ArtistID')))
data = data[columns]
data.head()

unique_values = data['Artist'].value_counts()
print(unique_values)

familiarity = data[data['Artist'] == 'Queen']
familiarity

familiarity.to_csv('familiarity.csv', index=False)

exploration = data.drop_duplicates(subset=['Artist'], keep='first')
exploration

exploration.to_csv('exploration.csv', index=False)

timelessness = data[data['Year'] < 2000]
timelessness

timelessness.to_csv('timelessness.csv', index=False)

newness = data[data['Year'] >= 2000]
newness

newness.to_csv('newness.csv', index=False)

data['Top Genre'].value_counts()

loyalty = data.sample(n=3, random_state=56)
loyalty

loyalty.to_csv('loyalty.csv', index=False)

variety = data.drop_duplicates(subset=['Title'], keep='first')
variety

variety.to_csv('variety.csv', index=False)

data['Popularity'].max()

data['Popularity'].min()

commonality = data.nlargest(20, 'Popularity')
commonality

commonality.to_csv('commonality.csv', index=False)

uniqueness = data.nsmallest(20, 'Popularity')
uniqueness

uniqueness.to_csv('uniqueness.csv', index=False)